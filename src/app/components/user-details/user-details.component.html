<div class="container">
    <h2>User Profile</h2>
    <button class="btn btn-secondary mb-3" (click)="isEditOpen = !isEditOpen">
        {{ isEditOpen ? 'Cancel' : 'Edit Profile' }}
    </button>

    <form (ngSubmit)="onSubmit()" #form="ngForm">
        <!-- Full Name Field -->
        <div class="form-group">
            <label>Full Name</label>
            <div *ngIf="!isEditOpen">
                <p>{{ fullname }}</p>
            </div>
            <div *ngIf="isEditOpen">
                <input type="text" class="form-control" [(ngModel)]="fullname" name="fullname" required pattern="^[A-Za-z ]+$" #fullname="ngModel" />
                <div *ngIf="fullname.invalid && (fullname.touched || form.submitted)" class="alert alert-danger">
                    <div *ngIf="fullname.errors?.['required']">Full Name is required</div>
                    <div *ngIf="fullname.errors?.['pattern']">Only alphabets and spaces are allowed</div>
                </div>
            </div>
        </div>

        <!-- Mobile Field -->
        <div class="form-group">
            <label>Mobile</label>
            <div *ngIf="!isEditOpen">
                <p>{{ mobile }}</p>
            </div>
            <div *ngIf="isEditOpen">
                <input type="text" class="form-control" [(ngModel)]="mobile" name="mobile" required pattern="^\d{10}$" #mobile="ngModel" />
                <div *ngIf="mobile.invalid && (mobile.touched || form.submitted)" class="alert alert-danger">
                    <div *ngIf="mobile.errors?.['required']">Mobile is required</div>
                    <div *ngIf="mobile.errors?.['pattern']">The mobile number must be 10 digits</div>
                </div>
            </div>
        </div>

        <!-- Address Field -->
        <div class="form-group">
            <label>Address</label>
            <div *ngIf="!isEditOpen">
                <p>{{ address }}</p>
            </div>
            <div *ngIf="isEditOpen">
                <input type="text" class="form-control" [(ngModel)]="address" name="address" required #address="ngModel" />
                <div *ngIf="address.invalid && (address.touched || form.submitted)" class="alert alert-danger">
                    <div *ngIf="address.errors?.['required']">Address is required</div>
                </div>
            </div>
        </div>

        <!-- Password Field -->
        <div class="form-group">
            <label>Password</label>
            <div *ngIf="isEditOpen">
                <input type="password" class="form-control" [(ngModel)]="password" name="password" required pattern="^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$" #password="ngModel" />
                <div *ngIf="password.invalid && (password.touched || form.submitted)" class="alert alert-danger">
                    <div *ngIf="password.errors?.['required']">Password is required</div>
                    <div *ngIf="password.errors?.['pattern']">Password must be at least 8 characters long, contain a letter, number, and special character</div>
                </div>
            </div>
        </div>

        <!-- Repeat Password Field -->
        <div class="form-group">
            <label>Repeat Password</label>
            <div *ngIf="isEditOpen">
                <input type="password" class="form-control" [(ngModel)]="repassword" name="repassword" required #repassword="ngModel" />
                <div *ngIf="repassword.invalid && (repassword.touched || form.submitted)" class="alert alert-danger">
                    <div *ngIf="repassword.errors?.['required']">Repeat Password is required</div>
                    <div *ngIf="repassword.value !== password">Passwords do not match</div>
                </div>
            </div>
        </div>

        <!-- Gender Field -->
        <div class="form-group">
            <label>Gender</label>
            <div *ngIf="!isEditOpen">
                <p>{{ gender }}</p>
            </div>
            <div *ngIf="isEditOpen">
                <div>
                    <input type="radio" [(ngModel)]="gender" name="gender" value="male" required #gender="ngModel" /> Male
                    <input type="radio" [(ngModel)]="gender" name="gender" value="female" required /> Female
                    <input type="radio" [(ngModel)]="gender" name="gender" value="other" required /> Other
                </div>
                <div *ngIf="gender.invalid && (gender.touched || form.submitted)" class="alert alert-danger">
                    <div *ngIf="gender.errors?.['required']">Gender is required</div>
                </div>
            </div>
        </div>

        <!-- Date of Birth Field -->
        <div class="form-group">
            <label>Date of Birth</label>
            <div *ngIf="!isEditOpen">
                <p>{{ dob | date: 'longDate' }}</p>
            </div>
            <div *ngIf="isEditOpen">
                <input type="date" class="form-control" [(ngModel)]="dob" name="dob" required #dob="ngModel" />
                <div *ngIf="dob.invalid && (dob.touched || form.submitted)" class="alert alert-danger">
                    <div *ngIf="dob.errors?.['required']">Date of Birth is required</div>
                </div>
            </div>
        </div>

        <!-- Submit Button -->
        <button type="submit" class="btn btn-primary" [disabled]="form.invalid" *ngIf="isEditOpen">Submit</button>
    </form>
</div>
